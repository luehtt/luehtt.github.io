<!DOCTYPE html>
<html>
<title>How to use Angular 6 Reactive form</title>
<xmp theme="united" style="display:none;">

# How to use Angular 6 Reactive form

  Read more: [Reactive form](https://angular.io/guide/reactive-forms)
  Read more: [Template-driven forms](https://angular.io/guide/forms)
  Read more: [Form Validation](https://angular.io/guide/form-validation)
  
Reactive forms provide a model-driven approach to handling form inputs whose values change over time. This guide shows you how to create and update a simple form control, progress to using multiple controls in a group, validate form values, and implement more advanced forms.

### Step 1: Register the reactive forms module
To use reactive forms, import **ReactiveFormsModule** from the **@angular/forms** package and add it to **app.module.ts** imports.
```
import { BrowserModule } from '@angular/platform-browser';
import { NgModule } from '@angular/core';
import { ReactiveFormsModule } from '@angular/forms';
import { HttpClientModule } from '@angular/common/http';

@NgModule({
  declarations: [ AppComponent ],
  imports: [ BrowserModule, AppRoutingModule, HttpClientModule, ReactiveFormsModule ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }
```

### Step 2: Open the component and declare form and formBuilder
The **FormControl** class is the basic building block when using reactive forms. To register a single form control, import the **FormControl** into the component... :sunglasses:. Let's import **FormBuilder**, **FormGroup**, and **Validators** classes instead to group these invidual form control into a group.
In this example, the form consists of 3 controls, namely username, email, and phone. The username and email fields are **required**.
```
import { FormBuilder, FormGroup, Validators } from '@angular/forms';

export class ReactiveFormComponent implements OnInit {
    form: FormGroup;
    
    constructor(private formBuilder: FormBuilder) { }
    
    ngOnInit() {
      this.form = this.formBuilder.group({
        username: ['', [Validators.required]],
        email: ['', [Validators.required, Validators.email]],
        phone: [''],
    });
  }
}
```

### Step 3: Open the view and construct the form in html
After we create the control in the component class, we must associate it with a form control element in the template. 
For each form controls, we also add **error** element right after to hinder the user on submit.
```
<form *ngIf="form" [formGroup]="form" (ngSubmit)="onSubmit()">
    <div class="form-group row">
        <label class="col-sm-4">Username</label>
        <div class="col-sm-8">
            <input type="text" class="form-control" formControlName="username" />
            <div class="text-danger" *ngIf="form.controls.username.touched && form.controls.username.errors">
            <small *ngIf="form.controls.username.errors.required">This username form control is required</small>
            </div>
        </div>
    </div>
    <div class="form-group row">
        <label class="col-sm-4">Email</label>
        <div class="col-sm-8">
            <input type="text" class="form-control" formControlName="email" />
            <div class="text-danger" *ngIf="form.controls.email.touched && form.controls.email.errors">
            <small *ngIf="form.controls.email.errors.required">This email form control is required</small>
            <small *ngIf="form.controls.email.errors.email">This email form control must be an email</small>
        </div>
    </div>
    <div class="form-group row">
        <label class="col-sm-4">Email</label>
        <div class="col-sm-8">
            <input type="text" class="form-control" formControlName="email" />
            <div class="text-danger" *ngIf="form.controls.email.touched && form.controls.email.errors">
            <small *ngIf="form.controls.email.errors.required">This email form control is required</small>
            <small *ngIf="form.controls.email.errors.email">This email form control must be an email</small>
        </div>
    </div>
    <div class="form-group row">
        <label class="col-sm-4">Phone</label>
        <div class="col-sm-8">
            <input type="text" class="form-control" formControlName="phone" />
        </div>
    </div>
</form>
```
### Step 4: Get form controls value and submit
Before submitting the data to the server, the **Validators** must confirm that all the controls are valid. The **touched** properties after the form control name is to mark if the user omit the field. Otherwise all the form controls are marked invalid at initial stage before user can actually touch the field. Then again, on validating the form, we must touch all field so that they are marked touched.
```
onSummit() {
    if (this.form.invalid) {
        for (let i in this.form.controls) {
            this.form.controls[i].markAsTouched();
        }
        return;
    }
    
    let item = {
        username = this.form.controls.username.value;
        email = this.form.controls.email.value;
        address = this.form.controls.address.value;
    }
    
    // this service calling is just example on posting new item
    this.service.post(item).then(res => {
        // codes on success
    })
    .catch(err => {
        // codes on error
    });
}
```

</xmp>

<script src="https://cdn.jsdelivr.net/gh/Naereen/StrapDown.js@master/strapdown.min.js"></script>
</html>
